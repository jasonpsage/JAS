{==============================================================================
|    _________ _______  _______  ______  _______  Jegas, LLC                  |
|   /___  ___// _____/ / _____/ / __  / / _____/  JasonPSage@jegas.com        |
|      / /   / /__    / / ___  / /_/ / / /____                                |
|     / /   / ____/  / / /  / / __  / /____  /                                |
|____/ /   / /___   / /__/ / / / / / _____/ /                                 |
/_____/   /______/ /______/ /_/ /_/ /______/                                  |
|                 Under the Hood                                              |
===============================================================================
                       Copyright(c)2012 Jegas, LLC
==============================================================================}

//=============================================================================
{}
// Test Various Components of the Jegas Database Layer
program test_ug_jado02;
//=============================================================================


//=============================================================================
// Global Directives
//=============================================================================
{$INCLUDE i_jegas_splash.pp}
{$INCLUDE i_jegas_macros.pp}
{$DEFINE SOURCEFILE:='test_ug_jado02.pas'}
{$SMARTLINK ON}
{$PACKRECORDS 4}
{$MODE objfpc}
//=============================================================================


//=============================================================================
Uses 
//=============================================================================
  ug_common,
  ug_jegas,
  ug_jado,
  sysutils;
//=============================================================================


//*****************************************************************************
//=============================================================================
//*****************************************************************************
// !@!Declarations 
//*****************************************************************************
//=============================================================================
//*****************************************************************************
Var 
  saFilename: AnsiString;
  JADOC: JADO_CONNECTION;
  //JADOR: JADO_RECORDSET;

//*****************************************************************************
//=============================================================================
//*****************************************************************************
//
//            
//*****************************************************************************
//=============================================================================
//*****************************************************************************

//=============================================================================

//=============================================================================
// Initialization
//=============================================================================
Var bSuccess:Boolean;
Begin
//=============================================================================
  deleteFile(csLOG_FILENAME_DEFAULT);
  saFilename:='Test_ODBC.dsn';
  JADOC:=JADO_CONNECTION.Create;
  bSuccess:=JADOC.bLoad(saFilename);
  If not bSuccess Then  Writeln('JADO bLoad FAILED.');
  If bsuccess Then
  Begin
    bSuccess:=JADOC.OpenCon;
    If not bSuccess Then 
    Begin
      Writeln('bOpenCon Failed.');
      saFilename:='Test_ODBCOutput.dsn';
      deletefile(saFilename);
      If not JADOC.bSave(saFilename) Then
      Begin
        Writeln('unable to save:',saFilename);
      End
      Else
      Begin
        Writeln('Saved DSN File Successfully:',saFilename);
      End;
    End;
  End;
  JADOC.Destroy;
  
  If bSuccess Then
  Begin
  End;    
  writeln('Good Bye');  
  
//=============================================================================
End.
//=============================================================================


//*****************************************************************************
// eof
//*****************************************************************************
